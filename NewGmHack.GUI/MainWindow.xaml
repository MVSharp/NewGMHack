<mah:MetroWindow x:Class="NewGmHack.GUI.MainWindow"
                 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                 xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                 xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                 xmlns:local="clr-namespace:NewGmHack.GUI"
                 xmlns:mah="http://metro.mahapps.com/winfx/xaml/controls"
                 xmlns:b="http://schemas.microsoft.com/xaml/behaviors"
                 mc:Ignorable="d"
                 d:DataContext="{d:DesignInstance local:MainWindow,
                                     IsDesignTimeCreatable=True}"
                 xmlns:Dialog="clr-namespace:MahApps.Metro.Controls.Dialogs;assembly=MahApps.Metro"
                 xmlns:views="clr-namespace:NewGmHack.GUI.Views"
                 Dialog:DialogParticipation.Register="{Binding}"
                 Background="#1E1E2F"
                 Foreground="White"
                 FontFamily="Segoe UI"
                 Title="New Sd Hack" Height="450" Width="800">
    <b:Interaction.Triggers>
        <b:EventTrigger EventName="Loaded">
            <b:InvokeCommandAction Command="{Binding LoadedCommand}" />
        </b:EventTrigger>
    </b:Interaction.Triggers>

    <Grid>
        <DockPanel Margin="10">
            <!-- 🧭 Top Bar Controls -->
            <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" HorizontalAlignment="Left" Margin="0,0,0,10">
                <Button Content="Inject"
                        IsEnabled="{Binding IsConnected , Converter={StaticResource ReversedBoolConverter}}"
                        Command="{Binding InjectCommand}" Width="100" Margin="0,0,10,0" />
                <Button Content="Deattach" IsEnabled="{Binding IsConnected}" Command="{Binding DeattachCommand}"></Button>
                <!-- <CheckBox Content="Mission Mode" IsChecked="{Binding IsMissionBomb}" Margin="0,0,10,0"/> -->
                <!-- <CheckBox Content="Player Mode" IsChecked="{Binding IsPlayerBomb}" Margin="0,0,10,0"/> -->
                <!-- <CheckBox Content="Random Location" IsChecked="{Binding IsRandomLocation}" Margin="0,0,10,0"/> -->

                <ItemsControl ItemsSource="{Binding Features}">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <StackPanel Orientation="Horizontal" />
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <CheckBox Content="{Binding Name}" IsChecked="{Binding IsEnabled}" Margin="0,0,10,0" />
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
                <TextBlock Text="Health Check:" VerticalAlignment="Center" Margin="20,0,5,0" />
                <Ellipse Width="16" Height="16"
                         Fill="{Binding IsConnected , Converter={StaticResource HealthCheckConverter}}" Stroke="White"
                         StrokeThickness="1" />
            </StackPanel>

            <!-- 📋 Main Content -->
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="*" />
                    <RowDefinition Height="100" />
                </Grid.RowDefinitions>
                <!--📑 Tabs-->
                <TabControl ItemsSource="{Binding Tabs}" />
                <!-- 📜 Logging Section -->
                <DataGrid Grid.Row="1"
                          ItemsSource="{Binding LogEntries}"
                          AutoGenerateColumns="False"
                          HeadersVisibility="Column"
                          Background="#2D2D3A"
                          Foreground="White"
                          Margin="0,3,0,0">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Time" Binding="{Binding Timestamp}" Width="150" />
                        <DataGridTextColumn Header="Message" Binding="{Binding Message}" Width="*" />
                    </DataGrid.Columns>
                </DataGrid>
            </Grid>
        </DockPanel>
    </Grid>
</mah:MetroWindow>